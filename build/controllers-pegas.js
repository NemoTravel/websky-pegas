!function(){function e(r,t,n){function s(i,o){if(!t[i]){if(!r[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=t[i]={exports:{}};r[i][0].call(d.exports,function(e){var t=r[i][1][e];return s(t||e)},d,d.exports,e,r,t,n)}return t[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)s(n[i]);return s}return e}()({1:[function(e,r,t){"use strict";function n(e,r,t,n){function s(){h.locked||t.checkServiceRemovalProhibited("meal")||(h.service.active=!h.service.active,h.service.active?o():t.removeExtraService({code:"meal"}))}function a(){t.removeExtraService({code:"meal"})}function i(e,r){h.selectedFlight=e,h.selectedPassenger=r,l()}function o(){h.selectedFlight=f(),h.selectedPassenger=p(h.selectedFlight),l()}function l(){h.mealMenu=h.service.itemsByPassengerSegments[h.selectedPassenger][h.selectedFlight],h.mealMenuSubgroup=!1}function c(e,r,n){h.locked||t.modifyExtraService({code:"meal",passenger_id:h.orderInfo.passengers[h.selectedPassenger].id,segment_id:h.orderInfo.plainFlights[h.selectedFlight].id,subgroup:h.service.subgroups[e],amount:(r.alreadySelectedCount||0)+n,service_type:r.serviceType,rfisc:r.rfisc})}function d(e,r){h.locked||t.checkServiceRemovalProhibited("meal",e,r)||t.removeExtraService({code:"meal",passenger_id:h.orderInfo.passengers[e].id,segment_id:h.orderInfo.plainFlights[r].id})}function g(e,r){var t,n=0,s=0;return h.orderInfo.groupedEditableExtraServices&&h.orderInfo.groupedEditableExtraServices.meal&&h.orderInfo.groupedEditableExtraServices.meal[e]&&h.orderInfo.groupedEditableExtraServices.meal[e][r]&&h.orderInfo.groupedEditableExtraServices.meal[e][r].length&&h.orderInfo.groupedEditableExtraServices.meal[e][r].forEach(function(e){e.amount&&(n+=e.amount),e.totalPrice&&(s=Big(s).plus(e.totalPrice).toFixed(2),t=e.currency)}),n?{count:n,cost:s,currency:t}:!1}function u(){S.scrollTo(0)}function m(){S.scrollTo(S[0].scrollWidth)}function v(){var r=S[0].scrollLeft,t=S[0].scrollWidth,n=S[0].clientWidth,s=t-n-r;h.canScrollRight=0!==s,h.canScrollLeft=0!==r,e.$apply()}function f(){var e;for(e=0;e<h.orderInfo.plainFlights.length;e++)if(h.service.availableBySegments[e])return e;return-1}function p(e){var r;if(h.service.availableByPassengerSegments)for(r=0;r<h.orderInfo.passengers.length;r++)if(h.service.availableByPassengerSegments[r][e])return r;return-1}var h=this,S=r.find("div.passengersTableContainer");h.switchService=s,h.resetService=a,h.selectFlightPassenger=i,h.selectFirstAvailablePassengerFlight=o,h.mealCountChangeHandler=c,h.removePassengerFlightMeal=d,h.getSelectedPassengerFlightMeal=g,h.scrollToStart=u,h.scrollToEnd=m,h.hasAlias=t.hasAlias,h.getAvailablePassengersCount=n.getAvailablePassengersCount,h.checkServiceRemovalProhibited=t.checkServiceRemovalProhibited,h.canScrollRight=!0,h.canScrollLeft=!1,h.selectedFlight=0,h.selectedPassenger=0,t.getParam("site.externalStorageBaseUrl")?h.mealImagesPath=t.getParam("site.externalStorageBaseUrl")+"/img/content/meal":h.mealImagesPath="./themes/websky/assets/static/img/content/meal",t.addOrderInfoListener(function(e){h.orderInfo=e},!1,!0),e.$watch("vm.service",function(){l()}),S.on("scroll",v),h.service.active&&l()}angular.module("app").component("esMealPegas",{templateUrl:"components/es-meal-pegas/es-meal-pegas.html",controller:["$scope","$element","backend","utils",n],controllerAs:"vm",bindings:{service:"=service",locked:"=locked"}})},{}],2:[function(e,r,t){"use strict";e("./components/es-meal-pegas/es-meal-pegas")},{"./components/es-meal-pegas/es-meal-pegas":1}]},{},[2]);
//# sourceMappingURL=controllers-pegas.js.map
